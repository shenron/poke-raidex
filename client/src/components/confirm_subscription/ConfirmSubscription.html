<v-card class="mx-auto">
  <v-card-title>
    <v-btn icon
      v-if="isSubscribed"
      :color="hasBeenChanged ? 'orange' : 'green'"
      dark>
      <v-icon dark>mdi-checkbox-marked-circle</v-icon>
    </v-btn>

    <v-tooltip right>
      <template v-slot:activator="{ on }">
        <v-badge>
          <span v-text="dateStr"></span>
          <template v-slot:badge><span v-on="on"
              v-text="usersLength"></span></template>
        </v-badge>
      </template>
      <span>{{ usersLength }} Participants</span>
    </v-tooltip>
  </v-card-title>

  <v-card-text>
    <p v-text="areaLabel"></p>

    <v-row v-for="(userEvent, i) in userEvents"
      :key="userEvent.accountId"
      class="text--primary">
      <v-col cols="3"
        class="pt-6">
        <v-btn @click="userEvents.splice(i, 1)"
          x-small
          class="mr-2"
          fab>
          <v-icon dark>mdi-minus</v-icon>
        </v-btn>

        <v-btn x-small
          fab>
          <v-icon dark>mdi-delete</v-icon>
        </v-btn>
      </v-col>

      <v-col md="5">
        <v-select v-model="userEvent.accountId"
          :items="getDistinctAccounts(userEvent)"
          item-value="id"
          item-text="label"
          label="Compte"
          persistent-hint></v-select>
      </v-col>

      <v-col md="4">
        <v-select v-model="userEvent.teamId"
          :items="getDistinctTeams(userEvent)"
          item-text="label"
          item-value="id"
          label="Chez les"></v-select>
      </v-col>
    </v-row>

    <!-- free sub accoun -->
    <v-row class="text--primary">
      <v-col cols="3"
        class="pt-6">
        <v-btn x-small
          class="mr-2"
          fab>
          <v-icon dark>mdi-plus</v-icon>
        </v-btn>
      </v-col>

      <v-col md="5">
        <v-text-field v-model="newAccount"
          label="Compte"></v-text-field>
      </v-col>

      <v-col md="4">
        <v-select :items="getDistinctTeams(null)"
          item-text="label"
          item-value="id"
          label="Chez les"></v-select>
      </v-col>
    </v-row>
  </v-card-text>

  <v-card-actions>
    <v-dialog v-if="!isSubscribed || hasBeenChanged"
      key="dialog-edit"
      v-model="savedModal"
      persistent
      max-width="290">
      <template v-slot:activator="{ on }">
        <v-btn class="ma-2"
          v-on="on"
          :color="hasBeenChanged ? 'orange' : 'green'"
          :dark="isValidForm"
          :disabled="!isValidForm">
          <v-icon dark>mdi-checkbox-marked-circle</v-icon>
        </v-btn>
      </template>
      <v-card>
        <v-card-title class="headline">C'est dans la boite!</v-card-title>
        <v-card-actions>
          <div class="flex-grow-1"></div>
          <v-btn color="green darken-1"
            text
            @click="editSubscription">OK</v-btn>
        </v-card-actions>
      </v-card>
    </v-dialog>

    <v-dialog v-else-if="isSubscribed"
      v-model="leaveDialog"
      persistent
      max-width="290"
      key="dialog-unsubscribe">
      <template v-slot:activator="{ on }">
        <v-btn class="ma-2"
          v-on="on">
          <v-icon dark>mdi-exit-to-app</v-icon>
        </v-btn>
      </template>
      <v-card>
        <v-card-title class="headline">Quitter le Raid ex?</v-card-title>
        <v-card-text>Vous pouvez Ã  tout moment le rejoindre ;)</v-card-text>
        <v-card-actions>
          <div class="flex-grow-1"></div>
          <v-btn color="green darken-1"
            text
            @click="unsubscribe">Oui</v-btn>
          <v-btn color="green darken-1"
            text
            @click="leaveDialog = false">Non</v-btn>
        </v-card-actions>
      </v-card>
    </v-dialog>
  </v-card-actions>
</v-card>
